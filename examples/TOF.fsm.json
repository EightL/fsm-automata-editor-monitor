{
    "name": "TOF",
    "comment": "Timer to off, umí nastavit timeout a na požádání sdělit zbývající čas timeru.",
    "inputs": [
        "in",
        "set_to",
        "req_rt"
    ],
    "outputs": [
        "out",
        "rt"
    ],
    "variables": [
        {
            "name": "timeout",
            "type": "int",
            "init": 500
        }
    ],
    "states": [
        {
            "id": "IDLE",
            "initial": true,
            "onEnter": "if (ctx.defined(\"set_to\")) {\n  ctx.setVar(\"timeout\", std::atoi(ctx.valueof(\"set_to\").c_str()));\n}\nctx.output(\"out\", 0);\nctx.output(\"rt\", 0);"
        },
        {
            "id": "ACTIVE",
            "onEnter": "if (ctx.defined(\"set_to\")) {\n  ctx.setVar(\"timeout\", std::atoi(ctx.valueof(\"set_to\").c_str()));\n}\nctx.output(\"out\", 0);\nctx.output(\"rt\", 0);"
        },
        {
            "id": "TIMING",
            "onEnter": "if (ctx.defined(\"set_to\")) {\n  ctx.setVar(\"timeout\", std::atoi(ctx.valueof(\"set_to\").c_str()));\n}\nctx.output(\"out\", 0);\nctx.output(\"rt\", 0);"
        },
        {
            "id": "dsad",
            "onEnter": "if (ctx.defined(\"set_to\")) {\n  ctx.setVar(\"timeout\", std::atoi(ctx.valueof(\"set_to\").c_str()));\n}\nctx.output(\"out\", 0);\nctx.output(\"rt\", 0);"

        }
    ],
    "transitions": [
        {
            "from": "IDLE",
            "to": "ACTIVE",
            "trigger": "in",
            "guard": "atoi(valueof(\"in\"))==1"
        },
        {
            "from": "ACTIVE",
            "to": "TIMING",
            "trigger": "in",
            "guard": "atoi(valueof(\"in\"))==0"
        },
        {
            "from": "TIMING",
            "to": "ACTIVE",
            "trigger": "in",
            "guard": "atoi(valueof(\"in\"))==1"
        },
        {
            "from": "TIMING",
            "to": "IDLE",
            "delay_ms": "timeout"
        },
        {
            "from": "IDLE",
            "to": "IDLE",
            "trigger": "set_to"
        },
        {
            "from": "ACTIVE",
            "to": "ACTIVE",
            "trigger": "set_to"
        },
        {
            "from": "TIMING",
            "to": "TIMING",
            "trigger": "set_to"
        },
        {
            "from": "IDLE",
            "to": "IDLE",
            "trigger": "req_rt"
        },
        {
            "from": "ACTIVE",
            "to": "ACTIVE",
            "trigger": "req_rt"
        },
        {
            "from": "TIMING",
            "to": "TIMING",
            "trigger": "req_rt"
        },
        {
            "from": "IDLE",
            "to": "ACTIVE",
            "delay_ms": 0
        },
        {
            "from": "ACTIVE",
            "to": "ACTIVE",
            "delay_ms": 0
        },
        {
            "from": "IDLE",
            "to": "dsad",
            "guard": "atoi(valueof(\"in\"))==2",
            "delay_ms": 0
        }
    ]
}
